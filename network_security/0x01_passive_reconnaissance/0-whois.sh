#!/bin/bash
whois "$1" | awk 'BEGIN{s="";rpe=0;rfe=0;ape=0;afe=0;tpe=0;tfe=0}/Registrant Name:/{s=s"Registrant Name, ";sub(/.*Name:[[:space:]]*/,"");s=s$0"\n"}/Registrant Organization:/{s=s"Registrant Organization, ";sub(/.*Organization:[[:space:]]*/,"");s=s$0"\n"}/Registrant Street:/{s=s"Registrant Street, ";sub(/.*Street:[[:space:]]*/,"");s=s$0"\n"}/Registrant City:/{s=s"Registrant City, ";sub(/.*City:[[:space:]]*/,"");s=s$0"\n"}/Registrant State\/Province:/{s=s"Registrant State/Province, ";sub(/.*State\/Province:[[:space:]]*/,"");s=s$0"\n"}/Registrant Postal Code:/{s=s"Registrant Postal Code, ";sub(/.*Postal Code:[[:space:]]*/,"");s=s$0"\n"}/Registrant Country:/{s=s"Registrant Country, ";sub(/.*Country:[[:space:]]*/,"");s=s$0"\n"}/Registrant Phone Ext:/{s=s"Registrant Phone Ext:, ";sub(/.*Phone Ext:[[:space:]]*/,"");s=s$0"\n";rpe=1;next}/Registrant Phone:/{s=s"Registrant Phone, ";sub(/.*Phone:[[:space:]]*/,"");s=s$0"\n";if(!rpe){s=s"Registrant Phone Ext:, \n";rpe=1}}/Registrant Fax Ext:/{s=s"Registrant Fax Ext:, ";sub(/.*Fax Ext:[[:space:]]*/,"");s=s$0"\n";rfe=1;next}/Registrant Fax:/{s=s"Registrant Fax, ";sub(/.*Fax:[[:space:]]*/,"");s=s$0"\n";if(!rfe){s=s"Registrant Fax Ext:, \n";rfe=1}}/Registrant Email:/{s=s"Registrant Email, ";sub(/.*Email:[[:space:]]*/,"");s=s$0"\n"}/Admin Name:/{s=s"Admin Name, ";sub(/.*Name:[[:space:]]*/,"");s=s$0"\n"}/Admin Organization:/{s=s"Admin Organization, ";sub(/.*Organization:[[:space:]]*/,"");s=s$0"\n"}/Admin Street:/{s=s"Admin Street, ";sub(/.*Street:[[:space:]]*/,"");s=s$0"\n"}/Admin City:/{s=s"Admin City, ";sub(/.*City:[[:space:]]*/,"");s=s$0"\n"}/Admin State\/Province:/{s=s"Admin State/Province, ";sub(/.*State\/Province:[[:space:]]*/,"");s=s$0"\n"}/Admin Postal Code:/{s=s"Admin Postal Code, ";sub(/.*Postal Code:[[:space:]]*/,"");s=s$0"\n"}/Admin Country:/{s=s"Admin Country, ";sub(/.*Country:[[:space:]]*/,"");s=s$0"\n"}/Admin Phone Ext:/{s=s"Admin Phone Ext:, ";sub(/.*Phone Ext:[[:space:]]*/,"");s=s$0"\n";ape=1;next}/Admin Phone:/{s=s"Admin Phone, ";sub(/.*Phone:[[:space:]]*/,"");s=s$0"\n";if(!ape){s=s"Admin Phone Ext:, \n";ape=1}}/Admin Fax Ext:/{s=s"Admin Fax Ext:, ";sub(/.*Fax Ext:[[:space:]]*/,"");s=s$0"\n";afe=1;next}/Admin Fax:/{s=s"Admin Fax, ";sub(/.*Fax:[[:space:]]*/,"");s=s$0"\n";if(!afe){s=s"Admin Fax Ext:, \n";afe=1}}/Admin Email:/{s=s"Admin Email, ";sub(/.*Email:[[:space:]]*/,"");s=s$0"\n"}/Tech Name:/{s=s"Tech Name, ";sub(/.*Name:[[:space:]]*/,"");s=s$0"\n"}/Tech Organization:/{s=s"Tech Organization, ";sub(/.*Organization:[[:space:]]*/,"");s=s$0"\n"}/Tech Street:/{s=s"Tech Street, ";sub(/.*Street:[[:space:]]*/,"");s=s$0"\n"}/Tech City:/{s=s"Tech City, ";sub(/.*City:[[:space:]]*/,"");s=s$0"\n"}/Tech State\/Province:/{s=s"Tech State/Province, ";sub(/.*State\/Province:[[:space:]]*/,"");s=s$0"\n"}/Tech Postal Code:/{s=s"Tech Postal Code, ";sub(/.*Postal Code:[[:space:]]*/,"");s=s$0"\n"}/Tech Country:/{s=s"Tech Country, ";sub(/.*Country:[[:space:]]*/,"");s=s$0"\n"}/Tech Phone Ext:/{s=s"Tech Phone Ext:, ";sub(/.*Phone Ext:[[:space:]]*/,"");s=s$0"\n";tpe=1;next}/Tech Phone:/{s=s"Tech Phone, ";sub(/.*Phone:[[:space:]]*/,"");s=s$0"\n";if(!tpe){s=s"Tech Phone Ext:, \n";tpe=1}}/Tech Fax Ext:/{s=s"Tech Fax Ext:, ";sub(/.*Fax Ext:[[:space:]]*/,"");s=s$0"\n";tfe=1;next}/Tech Fax:/{s=s"Tech Fax, ";sub(/.*Fax:[[:space:]]*/,"");s=s$0"\n";if(!tfe){s=s"Tech Fax Ext:, \n";tfe=1}}/Tech Email:/{s=s"Tech Email, ";sub(/.*Email:[[:space:]]*/,"");s=s$0"\n"}END{printf "%s",s}' > "$1.csv"
